<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MovieLix - Temukan Film Favoritmu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #111827; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 10px; }
    </style>
</head>
<body class="bg-gray-900 text-white font-sans">

    <header class="bg-gray-800/50 backdrop-blur-sm sticky top-0 z-50">
        <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold text-red-600">MovieLix</a>
            <div class="relative">
                <input type="text" id="search-input" placeholder="Cari film..." class="bg-gray-700 text-white px-4 py-2 rounded-full w-48 sm:w-64 focus:outline-none focus:ring-2 focus:ring-red-600">
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 py-8">
        <div id="movie-sections">
            <!-- Sections akan diisi oleh JS -->
        </div>
    </main>

    <footer class="text-center py-8 text-gray-500 border-t border-gray-800">
        <p>Dibuat dengan TMDb API.</p>
    </footer>

    <script>
        const apiKey = '8c79e8986ea53efac75026e541207aa3';
        const apiUrlBase = 'https://api.themoviedb.org/3';
        const imageCardBaseUrl = 'https://image.tmdb.org/t/p/w500';

        const movieSectionsContainer = document.getElementById('movie-sections');
        const searchInput = document.getElementById('search-input');

        async function fetchData(endpoint) {
            const url = `${apiUrlBase}/${endpoint}?api_key=${apiKey}&language=en-US`;
            try {
                const response = await fetch(url);
                return await response.json();
            } catch (error) {
                console.error("Fetch Error:", error);
                return null;
            }
        }
        
        function createMovieCard(movie) {
             if (!movie.poster_path) return '';
             return `
                <a href="detail.html?id=${movie.id}" class="block group">
                    <img src="${imageCardBaseUrl}${movie.poster_path}" alt="${movie.title}" class="rounded-lg shadow-lg transform group-hover:scale-105 transition-transform duration-300">
                </a>
             `;
        }

        function createSection(title, movies) {
            const moviesHTML = movies.map(createMovieCard).join('');
            return `
                <section class="mb-12">
                    <h2 class="text-2xl font-semibold mb-4 border-l-4 border-red-600 pl-3">${title}</h2>
                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">${moviesHTML}</div>
                </section>
            `;
        }

        async function initializeHomepage() {
            movieSectionsContainer.innerHTML = '<p class="text-center text-xl">Loading...</p>';
            const [trending, nowPlaying, topRated] = await Promise.all([
                fetchData('trending/movie/week'),
                fetchData('movie/now_playing'),
                fetchData('movie/top_rated')
            ]);
            
            let content = '';
            if (trending) content += createSection('Trending Minggu Ini', trending.results);
            if (nowPlaying) content += createSection('Sedang Tayang', nowPlaying.results);
            if (topRated) content += createSection('Rating Tertinggi', topRated.results);
            movieSectionsContainer.innerHTML = content;
        }

        async function searchMovies(query) {
             if (query.trim() === '') {
                initializeHomepage();
                return;
            }
            movieSectionsContainer.innerHTML = `<p class="text-center text-xl">Mencari "${query}"...</p>`;
            const searchData = await fetchData(`search/movie?query=${encodeURIComponent(query)}`);
            if (searchData && searchData.results.length > 0) {
                 movieSectionsContainer.innerHTML = createSection(`Hasil untuk "${query}"`, searchData.results);
            } else {
                 movieSectionsContainer.innerHTML = `<p class="text-center text-xl">Tidak ada hasil untuk "${query}".</p>`;
            }
        }
        
        let searchTimeout;
        searchInput.addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => searchMovies(e.target.value), 500);
        });
        
        document.addEventListener('DOMContentLoaded', initializeHomepage);
    </script>
</body>
</html>
